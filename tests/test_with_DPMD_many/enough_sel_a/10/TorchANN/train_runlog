cuDNN version:  7401
Number of GPUs:  1
Using /tmp/torch_extensions as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /tmp/torch_extensions/test_from_cpp/build.ninja...
Building extension module test_from_cpp...
ninja: no work to do.
Loading extension module test_from_cpp...
All parameters:
>>> cutoff_1: 7.700000e+00
>>> cutoff_2: 8.000000e+00
>>> cutoff_3: 0.000000e+00
>>> cutoff_max: 8.000000e+00
>>> N_types_all_frame:  2
>>> type_index_all_frame: [15, 79]
>>> N_Atoms_max: 16
>>> SEL_A_max: 531
>>> Nframes_tot:  7
>>> sym_coord_type:  1
>>> N_sym_coord: 2124
>>> batch_size:  7
>>> stop_epoch:  1
>>> num_filter_layer:  3
>>> filter_neuron: [89, 117, 128]
>>> axis_neuron: 14
>>> num_fitting_layer:  4
>>> fitting_neuron: [253, 148, 144, 56]
>>> start_lr: 5.000000e-04
>>> (Not used)decay_steps: -1
>>> decay_epoch:  1
>>> decay_rate: 9.500000e-01
>>> start_pref_e: 1.000000e+00
>>> limit_pref_e: 1.000000e+00
>>> start_pref_f: 1.000000e+04
>>> limit_pref_f: 1.000000e+00
>>> check_step: 1000
>>> output_epoch: 10
>>> save_epoch: 10

Total number of frames:  7
Number of atoms aligned:  16
COORD_Reshape: shape =  (7, 48)
FORCE_Reshape: shape =  (7, 48)
TYPE_Reshape: shape =  (7, 16)
NEI_IDX_Reshape: shape =  (7, 8496)
NEI_COORD_Reshape: shape =  (7, 25488)
NEI_TYPE_Reshape: shape =  (59472,)
Data pre-processing complete. Building net work.

one_batch_net(
  (batch_norm): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (filter_input): ModuleList(
    (0): ModuleList(
      (0): Linear(in_features=1, out_features=89, bias=True)
      (1): Linear(in_features=1, out_features=89, bias=True)
    )
    (1): ModuleList(
      (0): Linear(in_features=1, out_features=89, bias=True)
      (1): Linear(in_features=1, out_features=89, bias=True)
    )
  )
  (filter_hidden): ModuleList(
    (0): ModuleList(
      (0): ModuleList(
        (0): Linear(in_features=89, out_features=117, bias=True)
        (1): Linear(in_features=117, out_features=128, bias=True)
      )
      (1): ModuleList(
        (0): Linear(in_features=89, out_features=117, bias=True)
        (1): Linear(in_features=117, out_features=128, bias=True)
      )
    )
    (1): ModuleList(
      (0): ModuleList(
        (0): Linear(in_features=89, out_features=117, bias=True)
        (1): Linear(in_features=117, out_features=128, bias=True)
      )
      (1): ModuleList(
        (0): Linear(in_features=89, out_features=117, bias=True)
        (1): Linear(in_features=117, out_features=128, bias=True)
      )
    )
  )
  (fitting_input): ModuleList(
    (0): Linear(in_features=1792, out_features=253, bias=True)
    (1): Linear(in_features=1792, out_features=253, bias=True)
  )
  (fitting_hidden): ModuleList(
    (0): ModuleList(
      (0): Linear(in_features=253, out_features=148, bias=True)
      (1): Linear(in_features=148, out_features=144, bias=True)
      (2): Linear(in_features=144, out_features=56, bias=True)
    )
    (1): ModuleList(
      (0): Linear(in_features=253, out_features=148, bias=True)
      (1): Linear(in_features=148, out_features=144, bias=True)
      (2): Linear(in_features=144, out_features=56, bias=True)
    )
  )
  (fitting_out): ModuleList(
    (0): Linear(in_features=56, out_features=1, bias=True)
    (1): Linear(in_features=56, out_features=1, bias=True)
  )
)
Number of parameters in the net: 1144988
Start training using device:  cuda , count:  1
LR update: lr = 0.000500
Force check:
 tensor([[ 0.0072183163,  0.0997527682,  0.0208820352,  0.0689573739,
          0.0893632224, -0.0021720968, -0.0094006890,  0.1911454305,
         -0.0284182895,  0.0230549430, -0.1558332638,  0.0379206995,
          0.0393852534, -0.0536292201,  0.0631641435,  0.0340663653,
          0.0929648811,  0.0162922662, -0.0100994850,  0.0588658679,
          0.0645106864, -0.0612598167, -0.0296527045, -0.0979814274,
         -0.0269933272, -0.0392969285,  0.0559435517,  0.0120762946,
         -0.1197499350, -0.0106878268,  0.0173322386, -0.0166520882,
         -0.1256545618, -0.0683012948, -0.0604778041, -0.0529487865,
         -0.0026015978,  0.0048795692,  0.0082965928, -0.0040230664,
         -0.0252138372,  0.0791559942,  0.0029457861, -0.0410758855,
         -0.0168268139, -0.0223572943,  0.0046099277, -0.0114761668],
        [ 0.0092214131,  0.1042681189,  0.0228212990,  0.0643369611,
          0.0849955586,  0.0014081929, -0.0124875091,  0.1866137447,
         -0.0225314062,  0.0288882562, -0.1578952865,  0.0320948094,
          0.0352549416, -0.0492134505,  0.0660567120,  0.0372772726,
          0.1012400800,  0.0203407504, -0.0125111591,  0.0598381237,
          0.0578648982, -0.0598602663, -0.0348636769, -0.0992259054,
         -0.0145787142, -0.0341783539,  0.0526056486,  0.0101189963,
         -0.1238602761, -0.0087825838,  0.0133171170, -0.0105504339,
         -0.1241564441, -0.0695359153, -0.0590706864, -0.0566372851,
          0.0010459331, -0.0036093164,  0.0075906794,  0.0021626035,
         -0.0210224631,  0.0838471992, -0.0038616692, -0.0419557832,
         -0.0239324340, -0.0287882614, -0.0007358990, -0.0093641307],
        [-0.0526802587, -0.1739854261,  0.1654330919,  0.0822091161,
          0.0572607483,  0.1642944592, -0.0048674264, -0.0307265979,
          0.0066863162,  0.0262822134,  0.0147473342, -0.0647259032,
          0.0209387815,  0.0546886629,  0.0090126908,  0.0118502777,
         -0.0014554435,  0.0436990397, -0.0937359152, -0.0156484817,
         -0.0458115500,  0.0149550975, -0.0120658599, -0.0139150515,
         -0.0097803656,  0.0990903330, -0.0221858206,  0.0091376019,
         -0.0851183251,  0.0021840075, -0.0209600551,  0.0914676451,
         -0.0273736216, -0.0182782475,  0.0329902270, -0.1208725995,
          0.0347880411,  0.0060736824,  0.0500521095, -0.0434160417,
          0.0069277694, -0.1353545214,  0.0465454180, -0.0262292471,
          0.0298807732, -0.0029882371, -0.0180170210, -0.0410034203],
        [-0.1252993657, -0.0258653659,  0.0308662081,  0.0554835522,
         -0.0666109212,  0.0733433223, -0.0472021457,  0.0055715232,
          0.0235783311, -0.0297033649, -0.0757434156, -0.0680727143,
          0.0286724803, -0.1230580840,  0.1023489238,  0.0221509722,
         -0.0011004044,  0.0135448320, -0.0315775520,  0.1207287036,
         -0.1160671438,  0.0322670994, -0.0165076024, -0.0050588968,
          0.0400434674, -0.0484643083, -0.0738080248, -0.0387550163,
         -0.0284075115,  0.0852957536,  0.0097234377,  0.1885780161,
          0.0360332375, -0.0138890232, -0.0112768602,  0.0452264120,
          0.0360981484, -0.0131518215, -0.0539766983, -0.0203079099,
          0.0142250652, -0.1623535106,  0.0301086165,  0.0520617694,
          0.0452531586,  0.0521866037,  0.0290212176,  0.0238468098],
        [-0.0583559612, -0.0246938431, -0.0028482192,  0.0097343572,
          0.0360690949, -0.0157670664,  0.0620507057,  0.0669419224,
         -0.0670913817, -0.0244411673,  0.0237252424,  0.1032298629,
         -0.0440846619, -0.0255852786,  0.0479658186,  0.0440056985,
          0.0008141095,  0.0805322321, -0.0125418505,  0.0159392814,
          0.0816940540, -0.0214499013, -0.0296017007, -0.0593892605,
          0.0269908468,  0.0037696842, -0.0374948975,  0.0074186005,
         -0.0030611855, -0.0803265900, -0.0183061810,  0.0079620797,
          0.0421887504, -0.0304497400,  0.0062706809,  0.0121123802,
          0.0036317698, -0.0449044775, -0.0028481911,  0.0197527366,
         -0.0164910209, -0.0198345552, -0.0228291502, -0.0376967866,
         -0.0945243738,  0.0588738984,  0.0205421975,  0.0124014372],
        [-0.0164882181,  0.0188937128,  0.0910908124,  0.0455870596,
          0.0459344901,  0.0836836969,  0.0141227858,  0.0350617599,
         -0.0251212550,  0.0327849184, -0.0246456089, -0.0386690371,
         -0.0589229150, -0.0919159074,  0.0788971969,  0.0375091487,
          0.0224761735, -0.0524686999, -0.0371574788,  0.0809371764,
         -0.1113865904,  0.0203419158, -0.0409164540, -0.0251097811,
         -0.0066530644, -0.0979099678, -0.1050572889,  0.0315281319,
          0.0252433131,  0.0145268376,  0.0150402824,  0.0749310149,
         -0.0109617566, -0.0238687161,  0.0145926970,  0.0176516784,
         -0.0186292909, -0.0232617490, -0.0147598229, -0.0383171539,
         -0.0839150660, -0.0274453351, -0.0568061857,  0.0356637589,
          0.0255658796,  0.0599287803,  0.0088306563,  0.0995634653],
        [ 0.0128375054, -0.0437613122,  0.1181829331, -0.0422703608,
          0.0245951704,  0.0363128612, -0.0181326534,  0.0267334447,
          0.0273832608,  0.0359926591,  0.0146744447, -0.0334935054,
          0.0582911770, -0.0478548692,  0.0082369067, -0.0151489558,
          0.0100279387, -0.0286170073, -0.0927912273,  0.0564365649,
         -0.0293627747,  0.0627604099, -0.0150317146, -0.0117585297,
          0.0062016430, -0.0689471836, -0.0746733261, -0.0452798100,
         -0.0050861713,  0.0362378840,  0.0338695079,  0.0787995747,
         -0.0819287558,  0.0026561338, -0.0175870694, -0.0106366226,
          0.0665336970,  0.0407412520, -0.0076159950, -0.0682071031,
         -0.0374700099, -0.0150829303,  0.0102247552, -0.0080788008,
         -0.0111476544, -0.0075373779, -0.0081912592,  0.0779632555]],
       device='cuda:0')
Additional parameters check:
 std:
 tensor([[[0.0733911309, 0.0457061609, 0.0457061609, 0.0457061609],
         [0.0732406760, 0.0456829083, 0.0456829083, 0.0456829083]]],
       device='cuda:0') 
avg:
 tensor([[[0.0296802939, 0.0000000000, 0.0000000000, 0.0000000000],
         [0.0299445712, 0.0000000000, 0.0000000000, 0.0000000000]]],
       device='cuda:0') 
use_std_avg True
Epoch: 0         , Batch: 0         , lossE:   5.219398 eV/atom, lossF:   0.384941 eV/A, time:      0.081 s
Rank 0: Model saved to ./freeze_model.pytorch
Training complete. Time elapsed:      0.140 s

