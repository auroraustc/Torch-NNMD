cuDNN version:  7401
Number of GPUs:  1
Using /tmp/torch_extensions as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /tmp/torch_extensions/test_from_cpp/build.ninja...
Building extension module test_from_cpp...
ninja: no work to do.
Loading extension module test_from_cpp...
All parameters:
>>> cutoff_1: 7.700000e+00
>>> cutoff_2: 8.000000e+00
>>> cutoff_3: 0.000000e+00
>>> cutoff_max: 8.000000e+00
>>> N_types_all_frame:  2
>>> type_index_all_frame: [15, 79]
>>> N_Atoms_max: 72
>>> SEL_A_max: 532
>>> Nframes_tot:  3
>>> sym_coord_type:  1
>>> N_sym_coord: 2128
>>> batch_size:  3
>>> stop_epoch:  1
>>> num_filter_layer:  3
>>> filter_neuron: [130, 36, 57]
>>> axis_neuron:  1
>>> num_fitting_layer:  4
>>> fitting_neuron: [253, 233, 113, 68]
>>> start_lr: 5.000000e-04
>>> (Not used)decay_steps: -1
>>> decay_epoch:  1
>>> decay_rate: 9.500000e-01
>>> start_pref_e: 1.000000e+00
>>> limit_pref_e: 1.000000e+00
>>> start_pref_f: 1.000000e+04
>>> limit_pref_f: 1.000000e+00
>>> check_step: 1000
>>> output_epoch: 10
>>> save_epoch: 10

Total number of frames:  3
Number of atoms aligned:  72
COORD_Reshape: shape =  (3, 216)
FORCE_Reshape: shape =  (3, 216)
TYPE_Reshape: shape =  (3, 72)
NEI_IDX_Reshape: shape =  (3, 38304)
NEI_COORD_Reshape: shape =  (3, 114912)
NEI_TYPE_Reshape: shape =  (114912,)
Data pre-processing complete. Building net work.

one_batch_net(
  (batch_norm): BatchNorm1d(72, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (filter_input): ModuleList(
    (0): ModuleList(
      (0): Linear(in_features=1, out_features=130, bias=True)
      (1): Linear(in_features=1, out_features=130, bias=True)
    )
    (1): ModuleList(
      (0): Linear(in_features=1, out_features=130, bias=True)
      (1): Linear(in_features=1, out_features=130, bias=True)
    )
  )
  (filter_hidden): ModuleList(
    (0): ModuleList(
      (0): ModuleList(
        (0): Linear(in_features=130, out_features=36, bias=True)
        (1): Linear(in_features=36, out_features=57, bias=True)
      )
      (1): ModuleList(
        (0): Linear(in_features=130, out_features=36, bias=True)
        (1): Linear(in_features=36, out_features=57, bias=True)
      )
    )
    (1): ModuleList(
      (0): ModuleList(
        (0): Linear(in_features=130, out_features=36, bias=True)
        (1): Linear(in_features=36, out_features=57, bias=True)
      )
      (1): ModuleList(
        (0): Linear(in_features=130, out_features=36, bias=True)
        (1): Linear(in_features=36, out_features=57, bias=True)
      )
    )
  )
  (fitting_input): ModuleList(
    (0): Linear(in_features=57, out_features=253, bias=True)
    (1): Linear(in_features=57, out_features=253, bias=True)
  )
  (fitting_hidden): ModuleList(
    (0): ModuleList(
      (0): Linear(in_features=253, out_features=233, bias=True)
      (1): Linear(in_features=233, out_features=113, bias=True)
      (2): Linear(in_features=113, out_features=68, bias=True)
    )
    (1): ModuleList(
      (0): Linear(in_features=253, out_features=233, bias=True)
      (1): Linear(in_features=233, out_features=113, bias=True)
      (2): Linear(in_features=113, out_features=68, bias=True)
    )
  )
  (fitting_out): ModuleList(
    (0): Linear(in_features=68, out_features=1, bias=True)
    (1): Linear(in_features=68, out_features=1, bias=True)
  )
)
Number of parameters in the net: 244722
Start training using device:  cuda , count:  1
LR update: lr = 0.000500
Force check:
 tensor([[ 5.0091740567e-03, -1.1825238358e-03,  3.6920678533e-03,
         -1.1074702778e-03,  1.3188988129e-03,  1.7328149506e-03,
         -5.3638901034e-04,  2.4958224551e-03, -2.2534227578e-03,
          3.0814622936e-03, -3.1044205534e-03, -1.1637218812e-03,
          2.6387880297e-03, -9.2470381338e-04,  6.8881188553e-04,
         -1.9960959963e-04,  2.3752420763e-03, -1.8033208114e-03,
         -7.0406781292e-05, -9.6110789505e-04,  5.9517228316e-04,
          1.6787854073e-03,  3.8913606425e-04, -9.7750948474e-04,
         -9.4893067099e-06,  3.8122246951e-04, -2.3176287434e-04,
         -3.9247476686e-03,  6.0766770030e-03,  1.4339218299e-03,
         -6.1333178012e-04, -5.3699631922e-04, -1.0400759754e-03,
         -2.4206216061e-04, -2.7216337365e-03,  9.1860668883e-04,
         -1.9283769625e-03,  1.2404591232e-03, -8.2321712920e-04,
          1.1782554851e-03,  2.8070535181e-03,  4.1836266244e-04,
          5.5324048973e-04, -2.1897906188e-03, -7.2291395810e-04,
          1.5670903738e-03,  3.9742128581e-04, -1.1456590286e-03,
          6.8069690078e-04, -2.9125421763e-03,  9.5752581837e-05,
          7.2614726364e-04,  8.8017123665e-04,  4.9716505384e-04,
         -1.1979669503e-03, -1.0262539873e-03,  8.6171741021e-04,
          1.1884422101e-03,  1.8657473785e-03,  3.8203923798e-04,
         -1.1263127534e-03,  3.6729668878e-04,  2.2982256601e-05,
          1.6292019695e-03,  8.8287511772e-04, -1.9455611421e-03,
         -6.9575141173e-04, -2.1878602800e-04,  1.8482267716e-03,
         -3.6927194255e-03,  6.3006049846e-05,  3.2731398937e-03,
          5.0855395813e-03, -2.3002079966e-04, -2.3122262271e-03,
          1.2501494753e-04, -1.2855446776e-04, -2.2713063403e-03,
         -7.5079770384e-04, -8.4988784523e-04, -2.7992608206e-03,
         -1.0774209450e-03,  1.0750350287e-04,  5.1787072763e-04,
         -4.8778322167e-03, -2.8518420966e-03,  4.1362858390e-03,
         -2.0625146496e-03, -2.7847508763e-03,  1.7292199844e-04,
         -2.8241642419e-03, -1.4258249162e-03, -1.6560886436e-03,
         -1.1414411094e-04, -9.0517325130e-04, -3.6652939647e-03,
         -2.5666330669e-03,  1.5970652135e-03,  1.6827407316e-03,
          2.1118257632e-03, -2.7963196449e-03, -7.6049362354e-04,
          4.2738509413e-04, -1.2010647358e-03,  3.2901331179e-04,
         -1.7386043370e-03,  1.1019187291e-03, -1.9317274100e-03,
         -1.3670519764e-03,  1.0028329813e-03,  1.6876756640e-03,
         -1.1748296288e-03,  2.7677701497e-03,  1.5246916027e-03,
          5.0730990765e-03, -4.8707935195e-04, -1.1010866121e-03,
          2.5806387733e-04, -1.5912565011e-04, -1.3620963195e-03,
         -2.0469417219e-03,  6.6990576330e-04,  2.8974456815e-03,
          2.6216304605e-03,  7.6715517913e-04, -3.7777638609e-04,
          7.0735956112e-04,  2.2252905298e-03,  5.6450487349e-04,
         -6.3073902148e-04, -2.6595582317e-04, -7.7286828259e-04,
         -3.6546302254e-04,  1.0543630758e-03,  2.9581407645e-03,
          1.5280568469e-04,  7.0504815098e-04,  6.1263080358e-04,
          1.6501841155e-03,  6.1748010350e-04,  5.0541232376e-04,
          1.2393026760e-03, -2.6659734201e-03, -2.1798610981e-03,
          1.7940744358e-03,  8.0493934235e-04,  7.7736900912e-04,
         -1.0486175049e-03,  1.3337335072e-03,  5.7185350328e-04,
          5.6008067803e-04,  1.8734635040e-03, -1.3930413493e-03,
         -1.4592027987e-03,  1.4605704762e-03, -1.4522185773e-03,
         -1.8631329720e-03, -5.3155758056e-04, -2.3485719489e-03,
         -1.3043864068e-03, -7.7561169230e-04,  1.1139129535e-03,
         -1.8587650532e-03, -7.0234389946e-04, -1.7096795129e-03,
         -7.5720481258e-04,  1.4679695061e-03,  2.2475753832e-03,
          1.1778860632e-03, -1.1118189194e-03, -2.7075722833e-03,
         -2.3822227861e-03,  1.1092319762e-03,  2.2166734035e-03,
          1.9884806639e-03, -1.7608005152e-03,  1.5842062640e-04,
          4.1269801261e-04,  2.1880487814e-03, -1.1417111943e-03,
          3.1079132227e-04, -2.1469013155e-04,  3.3639359056e-03,
          2.4022778756e-03,  5.3858118657e-05,  4.9444429971e-04,
          8.1886597108e-04, -1.4995949726e-03, -8.4172842757e-04,
          5.7100661965e-04, -1.9692560736e-04, -1.9778065299e-03,
          5.4942885484e-05, -2.0320025614e-03,  7.3905077200e-05,
         -2.4991278623e-03,  3.7639205041e-06,  2.8682183738e-03,
          1.5653766913e-03, -1.0608859610e-03, -1.1638035843e-03,
          1.0603842178e-04, -1.7074773157e-03, -1.7673564571e-03,
         -3.3747949821e-03,  1.5160554750e-03,  2.2343404511e-03,
          1.1669064631e-03,  6.1204136430e-04, -1.4386759556e-04,
         -5.5246660814e-04, -2.9962447057e-04, -2.7840225832e-03,
          1.7287710966e-03, -2.1573731606e-03,  2.5578661468e-03],
        [-4.5065734363e-05, -7.1981033813e-04, -3.0268540731e-04,
         -1.2809853036e-03, -4.6934857202e-04, -2.3479917778e-04,
          1.2518631443e-03, -1.7504774346e-03, -6.4778282492e-03,
          1.2070854183e-03,  2.5584825186e-03,  1.2230783144e-03,
         -9.4287552947e-04,  1.0453606332e-03,  1.9125697334e-03,
         -1.2803156444e-03, -4.3607519655e-04, -9.8222439640e-04,
         -7.8878668013e-04,  1.4151664590e-03,  3.0058872227e-03,
          1.5282662079e-03, -3.3505038842e-03,  3.0302429781e-03,
          6.5031790709e-04, -9.1531635999e-04,  1.8820416951e-03,
         -2.4589070919e-03, -4.7676788018e-04,  3.7789836360e-03,
         -1.8698561254e-03, -2.7885513112e-04, -2.0425693756e-03,
          3.3982710649e-04,  3.3998146002e-04, -2.0618866899e-03,
          2.0578797392e-03,  7.8436323896e-04,  1.9674795628e-03,
          1.6059010376e-03, -6.0932165622e-05, -8.1262807807e-04,
         -2.3586996569e-05,  2.8139482306e-03,  6.2354739907e-04,
         -1.4629997559e-03,  1.1388226153e-04, -4.1889319184e-03,
          1.0066391176e-03,  4.1633962257e-04, -1.5885582060e-03,
          3.1109168110e-03, -8.2985299950e-04,  2.1046480041e-03,
          2.5380086474e-03, -5.7055570373e-04,  3.9785748829e-04,
          1.1477440806e-03, -1.7564682537e-03,  9.4708516148e-04,
         -1.3114735481e-03,  3.1660502047e-04, -9.6136744850e-04,
          1.6486876972e-03,  1.2696350064e-03,  4.5590806855e-04,
          3.3520274722e-03, -3.7140202845e-03, -2.2928420717e-03,
          8.0844178658e-04, -2.9521950786e-04, -3.9713857871e-03,
          1.9864290942e-03,  8.0115144331e-04, -6.7195906685e-04,
         -2.8185794142e-03, -1.8252130892e-03, -1.8185858629e-03,
         -1.6166474460e-03, -1.1892848642e-03, -2.1430391374e-04,
         -9.4346731595e-04,  1.1815632082e-03,  5.3676425818e-03,
         -3.7791343784e-03, -3.5549797580e-03, -3.8795613965e-03,
         -8.2465070850e-04, -2.3860795764e-04,  1.2448726944e-03,
         -1.9692439650e-03,  1.5163257449e-03,  4.5608300448e-03,
         -8.8037934508e-04, -6.4387042130e-05,  3.6126846562e-03,
         -3.5546649951e-03,  5.4647926591e-04, -4.2499504476e-03,
         -1.9230926449e-03,  4.8892079189e-04,  1.3138483833e-03,
          2.4580667291e-04,  6.9523024058e-04, -3.6109041831e-03,
         -3.7360254801e-04,  6.1011044669e-03, -4.4317560270e-03,
         -8.1440569328e-04, -1.5382065821e-05,  2.5082796149e-03,
         -2.0221691439e-04,  1.2866755370e-03,  2.2268623365e-04,
          1.4270180237e-03,  1.1822907173e-04,  9.8753434853e-04,
          6.4952699905e-05, -7.1808064795e-04, -1.8534928283e-05,
          2.3885631476e-03,  8.2184433562e-04, -3.7515918964e-04,
          2.7125783458e-04, -1.9617475599e-04,  1.8968334799e-03,
         -1.2795353564e-03, -3.9320615480e-04,  4.6575985833e-05,
          8.5872854393e-04, -4.7245612689e-04,  1.6748731829e-03,
          1.8146599603e-03, -2.5084714165e-03, -1.0948531730e-03,
         -1.0624748489e-04,  6.2650291635e-05, -6.2052717046e-04,
          1.7757555629e-03, -8.0877392823e-04, -2.2907871016e-05,
         -1.4757599508e-03,  1.7988802250e-03,  8.9354389116e-04,
          3.9844634975e-04,  1.6006823628e-03, -2.4660468597e-03,
         -1.3409679098e-03, -2.1451092881e-04, -3.5108560158e-05,
          1.1698190859e-03,  2.6489018456e-03, -2.1201302302e-03,
         -2.6403521575e-03, -1.1175247674e-03,  2.7872637199e-03,
          7.7484755908e-04,  1.7214349429e-03, -1.2571563293e-03,
         -4.1099124229e-04, -2.2979778003e-03, -2.0747774968e-03,
          2.8481848316e-03,  2.8568711877e-04,  1.7068762652e-04,
         -1.3629064297e-03, -1.1435547202e-03, -7.3536545632e-04,
          9.5049922055e-04,  9.3848713517e-04,  6.0512991042e-04,
         -9.7708035944e-04, -1.4307163973e-03, -2.4257573462e-03,
         -1.0857163585e-03, -2.1405113909e-03, -2.6673950115e-04,
         -3.4098845295e-05,  1.4746540896e-03,  4.2740706051e-03,
          2.7829957480e-03, -2.0740348368e-04,  2.3584370366e-03,
          2.3405275866e-03, -1.4262228028e-03, -1.6259167145e-03,
         -3.9199696321e-03,  1.6383336283e-04,  8.2991260004e-04,
          2.7107084650e-03, -1.6800479035e-03, -3.4596949091e-04,
         -1.3174008387e-03, -1.4118543790e-04,  2.1772959253e-03,
          2.5324179302e-04,  9.3324366367e-05,  6.8537868322e-05,
          2.9025449476e-03,  6.7694027637e-04,  2.5511135381e-03,
         -4.6713004726e-04,  3.5005614008e-04,  1.3818632840e-03,
         -2.8891521043e-06, -9.5136709418e-04, -1.8063844691e-04,
         -7.8727260377e-04,  1.0740033073e-03, -4.5788370088e-04,
         -2.1918684428e-04,  2.2449295626e-03,  1.3043418252e-04,
         -1.6261503088e-03,  5.9449066157e-04, -2.0760804889e-03],
        [-1.4796716315e-03, -1.5813242794e-03, -5.2079267975e-03,
          1.3505657366e-03,  7.4463516547e-04, -1.6193315378e-04,
          5.0644375723e-03,  4.9069131179e-03,  3.5193386442e-03,
         -1.3417869680e-04, -5.3451830785e-03,  3.5036098137e-03,
         -5.8741245740e-03,  2.4992089946e-04,  2.0353482713e-03,
          1.7404066712e-03, -8.6948788442e-04,  6.1310793379e-03,
         -9.6063791842e-04,  5.8800913029e-03,  1.5098086292e-03,
         -2.6833503780e-03, -2.9787612500e-03, -2.4403978089e-03,
          7.2273207541e-03,  9.7865383783e-05, -1.9919301739e-03,
         -1.0580588669e-03, -2.6877079619e-04,  1.8673005171e-03,
          8.7853978224e-04, -6.2934384758e-04, -4.8731355679e-05,
          4.9774663197e-03, -1.9293897726e-03, -9.7614412953e-04,
         -4.5787862414e-03, -1.8542353257e-04,  2.7960781336e-03,
          3.5318024280e-03,  1.2498800573e-03, -1.1527166296e-03,
         -5.4959309593e-04,  5.2776216778e-04, -1.3779989549e-03,
         -2.9619110378e-03, -2.2373917572e-03, -2.2216694576e-03,
         -5.5255216323e-04, -2.1912009886e-03, -1.3701256668e-03,
          2.2406751130e-05,  4.0218526837e-03, -5.5566299632e-03,
          1.8869796254e-03, -1.4892119303e-03,  2.7554416868e-03,
         -5.2501391188e-03, -7.1285609798e-04, -4.8788902561e-03,
          2.9601019916e-03, -5.3450175245e-03, -2.6733531580e-03,
         -2.3669903547e-03,  2.9186171654e-03, -7.1895127533e-04,
         -4.5887719374e-04,  4.9917291910e-03, -5.2935385471e-03,
          1.2820472610e-03, -7.2446455114e-03, -8.3416697500e-04,
         -2.1749947592e-03,  3.8590145627e-04, -8.2278909626e-05,
         -2.5064790158e-03,  2.6837739573e-04,  1.1700827313e-03,
         -3.5923956241e-03,  5.5485761555e-04,  1.3338010481e-03,
         -1.1300498496e-03,  2.0536006190e-03,  3.8720074069e-03,
         -3.6608614446e-04,  1.4177699150e-03, -2.0391574308e-03,
          1.2329927078e-03,  4.2949413548e-03,  4.4632367040e-03,
          1.8302574110e-03, -3.4676004346e-03,  3.6881912355e-03,
         -5.2281976647e-03,  9.2415842146e-04, -1.5200176555e-03,
         -6.0841913223e-04,  1.9695379895e-03, -6.8245256981e-04,
          4.3573532011e-03, -8.3424054816e-04, -3.3317885692e-03,
         -1.2913248752e-03,  2.9622640923e-03,  5.2524126513e-03,
         -3.9764718517e-05,  2.2088409569e-03, -1.7256972010e-03,
         -1.1054787962e-03, -7.6873918101e-05,  3.2445678377e-03,
          2.7370011976e-03, -2.5649021693e-03, -4.1225597455e-04,
          9.0758919733e-04, -5.7139849174e-04,  5.5390081953e-04,
          2.8231919372e-04, -8.3601336122e-04, -3.5597108562e-04,
          1.3729989133e-03, -6.2804786337e-04,  9.1286212239e-04,
         -5.2073773608e-04, -1.6050826700e-03,  1.5118846471e-03,
          3.5610711081e-05, -7.4148696979e-04,  9.8400661786e-04,
          4.9607052382e-04, -8.6864225536e-05,  8.5684384429e-04,
          7.6889842850e-04,  3.5153126616e-03,  2.6231506140e-05,
          3.0633115346e-04,  1.2264219984e-03, -1.8638867135e-03,
          2.7675291747e-03, -1.1422595358e-03,  9.5249352942e-04,
         -2.0892534982e-03, -5.2950727269e-03, -6.9341486398e-04,
         -1.8749965193e-03, -1.4881397935e-03,  3.2908775440e-03,
         -3.0202602176e-03,  1.2355497561e-03, -1.5722988383e-03,
          2.9549332590e-03, -1.1920668991e-03, -1.0784133291e-03,
          2.7713221891e-03,  3.9817285947e-03, -1.4002171321e-03,
          4.2427598817e-03,  5.5051321350e-05,  5.3641371191e-04,
          2.4128167770e-03, -9.1144666686e-04, -2.6597096920e-04,
         -1.6519040816e-03, -9.1774464537e-04, -1.6545449957e-04,
          6.9448381229e-04, -5.1373859360e-04,  1.1850025289e-03,
         -1.3590967012e-03, -2.4855124956e-03,  2.7784110340e-04,
         -1.6780391675e-03,  1.5530354558e-03,  1.0423773087e-03,
         -1.6698390940e-03, -1.5710250630e-03,  9.3159064761e-04,
          9.4100825269e-05,  5.2953805296e-04, -1.4811329871e-03,
          1.3405365742e-04,  1.5640385639e-03, -1.3592214115e-03,
         -1.4789079086e-03, -1.6085805840e-03,  1.8290915843e-03,
         -1.1010481477e-03,  6.5797794735e-04, -7.4393720353e-04,
          2.8342809864e-03,  2.0708824272e-03,  4.3829100428e-04,
         -2.3047475301e-03,  9.0230890066e-04, -4.1230722229e-04,
          1.7253295718e-03,  5.5331671724e-04,  1.9750471646e-04,
          1.1785793373e-03, -1.2553326211e-03, -8.2155760788e-04,
         -1.1095190617e-03, -1.1787813030e-03, -7.5835092537e-04,
          7.0917759226e-04,  1.9274589742e-03, -3.2306711442e-03,
         -4.2099697073e-04,  5.7185464757e-04, -1.4792127266e-04,
          4.2993581021e-04,  1.5644709312e-03,  1.2571938001e-03,
         -9.6739192057e-04, -5.5824407075e-04, -8.7723186593e-04]],
       device='cuda:0')
Additional parameters check:
 std:
 tensor([[[0.0749403273, 0.0466579339, 0.0466579339, 0.0466579339],
         [0.0766395523, 0.0484783949, 0.0484783949, 0.0484783949]]],
       device='cuda:0') 
avg:
 tensor([[[0.0302462516, 0.0000000000, 0.0000000000, 0.0000000000],
         [0.0343051504, 0.0000000000, 0.0000000000, 0.0000000000]]],
       device='cuda:0') 
use_std_avg True
Epoch: 0         , Batch: 0         , lossE:   3.341776 eV/atom, lossF:   0.760739 eV/A, time:      0.101 s
Rank 0: Model saved to ./freeze_model.pytorch
Training complete. Time elapsed:      0.160 s

