cuDNN version:  7401
Number of GPUs:  1
Using /tmp/torch_extensions as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /tmp/torch_extensions/test_from_cpp/build.ninja...
Building extension module test_from_cpp...
ninja: no work to do.
Loading extension module test_from_cpp...
All parameters:
>>> cutoff_1: 7.700000e+00
>>> cutoff_2: 8.000000e+00
>>> cutoff_3: 0.000000e+00
>>> cutoff_max: 8.000000e+00
>>> N_types_all_frame:  2
>>> type_index_all_frame: [15, 79]
>>> N_Atoms_max: 28
>>> SEL_A_max: 553
>>> Nframes_tot:  1
>>> sym_coord_type:  1
>>> N_sym_coord: 2212
>>> batch_size:  1
>>> stop_epoch:  1
>>> num_filter_layer:  3
>>> filter_neuron: [133, 94, 128]
>>> axis_neuron: 16
>>> num_fitting_layer:  4
>>> fitting_neuron: [300, 132, 87, 93]
>>> start_lr: 5.000000e-04
>>> (Not used)decay_steps: -1
>>> decay_epoch:  1
>>> decay_rate: 9.500000e-01
>>> start_pref_e: 1.000000e+00
>>> limit_pref_e: 1.000000e+00
>>> start_pref_f: 1.000000e+04
>>> limit_pref_f: 1.000000e+00
>>> check_step: 1000
>>> output_epoch: 10
>>> save_epoch: 10

Total number of frames:  1
Number of atoms aligned:  28
COORD_Reshape: shape =  (1, 84)
FORCE_Reshape: shape =  (1, 84)
TYPE_Reshape: shape =  (1, 28)
NEI_IDX_Reshape: shape =  (1, 15484)
NEI_COORD_Reshape: shape =  (1, 46452)
NEI_TYPE_Reshape: shape =  (15484,)
Data pre-processing complete. Building net work.

one_batch_net(
  (batch_norm): BatchNorm1d(28, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (filter_input): ModuleList(
    (0): ModuleList(
      (0): Linear(in_features=1, out_features=133, bias=True)
      (1): Linear(in_features=1, out_features=133, bias=True)
    )
    (1): ModuleList(
      (0): Linear(in_features=1, out_features=133, bias=True)
      (1): Linear(in_features=1, out_features=133, bias=True)
    )
  )
  (filter_hidden): ModuleList(
    (0): ModuleList(
      (0): ModuleList(
        (0): Linear(in_features=133, out_features=94, bias=True)
        (1): Linear(in_features=94, out_features=128, bias=True)
      )
      (1): ModuleList(
        (0): Linear(in_features=133, out_features=94, bias=True)
        (1): Linear(in_features=94, out_features=128, bias=True)
      )
    )
    (1): ModuleList(
      (0): ModuleList(
        (0): Linear(in_features=133, out_features=94, bias=True)
        (1): Linear(in_features=94, out_features=128, bias=True)
      )
      (1): ModuleList(
        (0): Linear(in_features=133, out_features=94, bias=True)
        (1): Linear(in_features=94, out_features=128, bias=True)
      )
    )
  )
  (fitting_input): ModuleList(
    (0): Linear(in_features=2048, out_features=300, bias=True)
    (1): Linear(in_features=2048, out_features=300, bias=True)
  )
  (fitting_hidden): ModuleList(
    (0): ModuleList(
      (0): Linear(in_features=300, out_features=132, bias=True)
      (1): Linear(in_features=132, out_features=87, bias=True)
      (2): Linear(in_features=87, out_features=93, bias=True)
    )
    (1): ModuleList(
      (0): Linear(in_features=300, out_features=132, bias=True)
      (1): Linear(in_features=132, out_features=87, bias=True)
      (2): Linear(in_features=87, out_features=93, bias=True)
    )
  )
  (fitting_out): ModuleList(
    (0): Linear(in_features=93, out_features=1, bias=True)
    (1): Linear(in_features=93, out_features=1, bias=True)
  )
)
Number of parameters in the net: 1448706
Start training using device:  cuda , count:  1
LR update: lr = 0.000500
Force check:
 tensor([[-0.0269696685,  0.0029391725, -0.0428543114, -0.0331781949,
         -0.0491169882,  0.1061014320,  0.0448210133, -0.0630634263,
         -0.0117767520, -0.0382413069, -0.0428187871, -0.0509216054,
          0.0240135418, -0.0290662673, -0.0365250529,  0.0107690980,
          0.0864172618,  0.1476406675, -0.0225389845,  0.0055364826,
         -0.1420341455, -0.0172087237,  0.0282965499,  0.0106753268,
         -0.0330473608, -0.0322668967,  0.0429412085,  0.0002813184,
          0.0002550840,  0.0773315262, -0.0476147339,  0.0261906759,
          0.0105354367, -0.0218283573, -0.0052265063, -0.0056002857,
         -0.0114857675, -0.0269471976, -0.0580865753,  0.0090301473,
          0.0082861603, -0.0293915961,  0.0153967818, -0.0075961269,
          0.0215703230,  0.0015635083, -0.0145494873, -0.0054621840,
          0.0072020299, -0.0077769353,  0.0465936609,  0.0255944376,
          0.0042261823,  0.0101798574,  0.0130969700,  0.0361158715,
          0.0196679797, -0.0019788495, -0.0111703072,  0.0071045980,
          0.0505604047, -0.0229636581, -0.0208815654,  0.0036249882,
          0.0174222955, -0.0561683661, -0.0257517849,  0.0211449288,
          0.0037334509,  0.0478648382, -0.0047150085, -0.0082605615,
         -0.0002199292,  0.0130105517,  0.0144185324,  0.0551894399,
          0.0241698439, -0.0177497868,  0.0291686050,  0.0337882189,
         -0.0516347789, -0.0581134610,  0.0094783131,  0.0188535671]],
       device='cuda:0')
Additional parameters check:
 std:
 tensor([[[0.0683754595, 0.0419316028, 0.0419316028, 0.0419316028],
         [0.0715515580, 0.0445709004, 0.0445709004, 0.0445709004]]],
       device='cuda:0') 
avg:
 tensor([[[0.0244862108, 0.0000000000, 0.0000000000, 0.0000000000],
         [0.0289839618, 0.0000000000, 0.0000000000, 0.0000000000]]],
       device='cuda:0') 
use_std_avg True
Epoch: 0         , Batch: 0         , lossE:   5.053908 eV/atom, lossF:   0.255427 eV/A, time:      0.048 s
Rank 0: Model saved to ./freeze_model.pytorch
Training complete. Time elapsed:      0.077 s

