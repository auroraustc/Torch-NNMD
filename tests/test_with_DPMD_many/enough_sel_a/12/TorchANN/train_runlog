cuDNN version:  7401
Number of GPUs:  1
Using /tmp/torch_extensions as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /tmp/torch_extensions/test_from_cpp/build.ninja...
Building extension module test_from_cpp...
ninja: no work to do.
Loading extension module test_from_cpp...
All parameters:
>>> cutoff_1: 7.700000e+00
>>> cutoff_2: 8.000000e+00
>>> cutoff_3: 0.000000e+00
>>> cutoff_max: 8.000000e+00
>>> N_types_all_frame:  2
>>> type_index_all_frame: [15, 79]
>>> N_Atoms_max: 16
>>> SEL_A_max: 546
>>> Nframes_tot:  1
>>> sym_coord_type:  1
>>> N_sym_coord: 2184
>>> batch_size:  1
>>> stop_epoch:  1
>>> num_filter_layer:  3
>>> filter_neuron: [87, 70, 47]
>>> axis_neuron:  2
>>> num_fitting_layer:  4
>>> fitting_neuron: [273, 164, 85, 72]
>>> start_lr: 5.000000e-04
>>> (Not used)decay_steps: -1
>>> decay_epoch:  1
>>> decay_rate: 9.500000e-01
>>> start_pref_e: 1.000000e+00
>>> limit_pref_e: 1.000000e+00
>>> start_pref_f: 1.000000e+04
>>> limit_pref_f: 1.000000e+00
>>> check_step: 1000
>>> output_epoch: 10
>>> save_epoch: 10

Total number of frames:  1
Number of atoms aligned:  16
COORD_Reshape: shape =  (1, 48)
FORCE_Reshape: shape =  (1, 48)
TYPE_Reshape: shape =  (1, 16)
NEI_IDX_Reshape: shape =  (1, 8736)
NEI_COORD_Reshape: shape =  (1, 26208)
NEI_TYPE_Reshape: shape =  (8736,)
Data pre-processing complete. Building net work.

one_batch_net(
  (batch_norm): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (filter_input): ModuleList(
    (0): ModuleList(
      (0): Linear(in_features=1, out_features=87, bias=True)
      (1): Linear(in_features=1, out_features=87, bias=True)
    )
    (1): ModuleList(
      (0): Linear(in_features=1, out_features=87, bias=True)
      (1): Linear(in_features=1, out_features=87, bias=True)
    )
  )
  (filter_hidden): ModuleList(
    (0): ModuleList(
      (0): ModuleList(
        (0): Linear(in_features=87, out_features=70, bias=True)
        (1): Linear(in_features=70, out_features=47, bias=True)
      )
      (1): ModuleList(
        (0): Linear(in_features=87, out_features=70, bias=True)
        (1): Linear(in_features=70, out_features=47, bias=True)
      )
    )
    (1): ModuleList(
      (0): ModuleList(
        (0): Linear(in_features=87, out_features=70, bias=True)
        (1): Linear(in_features=70, out_features=47, bias=True)
      )
      (1): ModuleList(
        (0): Linear(in_features=87, out_features=70, bias=True)
        (1): Linear(in_features=70, out_features=47, bias=True)
      )
    )
  )
  (fitting_input): ModuleList(
    (0): Linear(in_features=94, out_features=273, bias=True)
    (1): Linear(in_features=94, out_features=273, bias=True)
  )
  (fitting_hidden): ModuleList(
    (0): ModuleList(
      (0): Linear(in_features=273, out_features=164, bias=True)
      (1): Linear(in_features=164, out_features=85, bias=True)
      (2): Linear(in_features=85, out_features=72, bias=True)
    )
    (1): ModuleList(
      (0): Linear(in_features=273, out_features=164, bias=True)
      (1): Linear(in_features=164, out_features=85, bias=True)
      (2): Linear(in_features=85, out_features=72, bias=True)
    )
  )
  (fitting_out): ModuleList(
    (0): Linear(in_features=72, out_features=1, bias=True)
    (1): Linear(in_features=72, out_features=1, bias=True)
  )
)
Number of parameters in the net: 221038
Start training using device:  cuda , count:  1
LR update: lr = 0.000500
Force check:
 tensor([[ 5.3817845248e-03,  7.5514027321e-03, -9.2390696969e-03,
          8.4738415692e-04, -1.6220106767e-03,  1.0430857461e-02,
         -1.4586797004e-03, -5.8122340743e-04, -8.0510467304e-03,
         -1.5569614555e-03, -2.5031856483e-03,  2.6528572948e-03,
         -3.5672653208e-03,  3.6180339943e-03, -9.9700513336e-05,
         -1.8672391843e-03, -1.4324260556e-04,  8.9794948678e-03,
         -1.9668591806e-03, -1.0352513796e-04,  9.5453095582e-03,
         -1.6410164900e-03, -7.5564628053e-04, -1.7462374697e-03,
          2.7561025793e-03,  2.4387673732e-03, -7.4654843182e-03,
         -1.4202204294e-04, -3.2488826972e-03,  4.8187052822e-03,
          5.6126430277e-06,  1.7567930462e-03, -5.4671395444e-03,
         -6.1559264105e-04,  2.9505568253e-03,  8.2436447320e-03,
          2.3826657195e-03, -1.1296487896e-03, -4.4504325556e-03,
          2.5544433984e-03, -3.3922361677e-03,  3.9289568054e-04,
          3.9837357261e-04, -7.5892296035e-03,  2.7145279565e-03,
         -1.5107305789e-03,  2.7532770435e-03, -1.1259182005e-02]],
       device='cuda:0')
Additional parameters check:
 std:
 tensor([[[0.0677378193, 0.0411982258, 0.0411982258, 0.0411982258],
         [0.0682462577, 0.0417441616, 0.0417441616, 0.0417441616]]],
       device='cuda:0') 
avg:
 tensor([[[0.0228366439, 0.0000000000, 0.0000000000, 0.0000000000],
         [0.0238799827, 0.0000000000, 0.0000000000, 0.0000000000]]],
       device='cuda:0') 
use_std_avg True
Epoch: 0         , Batch: 0         , lossE:   2.588068 eV/atom, lossF:   0.451010 eV/A, time:      0.036 s
Rank 0: Model saved to ./freeze_model.pytorch
Training complete. Time elapsed:      0.043 s

